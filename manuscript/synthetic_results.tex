\section{Numerical simulations}
\label{sec:numerical-simulations}

\subsection{Flops count}
\label{subsec:flops-count}

Figure \ref{fig:1} shows the total number of flops for solving the overdetermined problem
(equation \ref{eq:delta-q-tilde-overdetermined}) with different equivalent-layer methods
(equations \ref{flops:cholesky}, \ref{flops:cgls}, \ref{flops:LS89}, \ref{flops:SU21}, 
\ref{flops:C92}, \ref{flops:reparameterization-cgls}, \ref{flops:SOB17}, \ref{flops:TOB20},
and \ref{flops:direct-deconv}), by considering 
the particular case in which $\mathbf{H} = \mathbf{I}_{P}$ (equation \ref{eq:reparameterization} and 
subsection \ref{subsec:formulation-without-reparameterization}),
$\mu = 0$ (equation \ref{eq:function-Gamma}), 
$\mathbf{W}_{d} = \mathbf{I}_{D}$ (equation \ref{eq:function-Phi}) and
$\bar{\mathbf{p}} = \mathbf{0}$ (equation \ref{eq:reparameterization-reference}), 
where $\mathbf{I}_{P}$ and $\mathbf{I}_{D}$ are the identities of order $P$ and $D$, respectively.
The flops are computed for different number of potential-field data ranging from $10,000$ to $1,000,000$.

FALTOU DEFINIR OS PARÂMETROS ESPECÍFICOS DE CADA MÉTODO

\subsection{Synthetic potential-field data}
\label{subsec:synthetic-data}

We create a model composed of three synthetic bodies:
a sphere centered at $(x, y, z) = (3, -2, 2) \: \mathrm{km}$, with radius of $1 \: \mathrm{km}$;
a sphere centered at $(x, y, z) = (1, 2.5, 1.8) \: \mathrm{km}$, with radius of $750 \: \mathrm{m}$; and
a right prism having polygonal horizontal cross-section, top at $z = 900 \: \mathrm{m}$ and thickness $600 \: \mathrm{m}$.
The density contrasts of the upper left sphere, upper right sphere and prism are, respectively, 
$600 \: \mathrm{kg}/\mathrm{m}^{3}$, $-500 \: \mathrm{kg}/\mathrm{m}^{3}$ and to $550 \: \mathrm{kg}/\mathrm{m}^{3}$. 
All synthetic bodies have a total-magnetization vector with intensity $3.46 \: \mathrm{A}/\mathrm{m}$, inclination $35.26^{\circ}$
and declination $45.0^{\circ}$.
We consider a main geomagnetic field with constant inclination $20.0^{\circ}$ and declination $35.0^{\circ}$.

We have computed noise-free gravity disturbance and total-field anomaly data $\mathbf{d}$ produced by the
model on the same regularly spaced grid of $50 \times 50$ points at $z = 50 \: \mathrm{m}$
(Figures \ref{fig:4}A and \ref{fig:7}A).
We have also simulated additional $L = 20$ gravity data sets $\mathbf{d}^{\ell}$, $\ell \in \{1:L\}$, 
by adding pseudo-random Gaussian noise 
with zero mean and crescent standard deviations to the noise-free data (Figure \ref{fig:1}A).
The standard deviations vary from $0.5\%$ to $10\%$ of the maximum absolute value in the noise-free data.
We applied the same procedure to produce additional $20$ noise-corrupted magnetic data sets from the
noise-free data shown in Figure \ref{fig:7}A.
Figures \ref{fig:4}B and \ref{fig:7}B show, respectively, the gravity disturbance and total-field anomaly data 
corrupted with maximum noise level.
The remaining noise-corrupted gravity and magnetic data are not shown.

\subsection{Stability analysis}

We set two planar equivalent layers having one source below each datum at a constant vertical coordinate $z = 300 \: \mathrm{m}$.
Note that, in this case, both layers have a number of sources $P$ equal to the number of data $D$.
One layer is formed by point masses and is applied to the synthetic gravity data.
The other is applied to the synthetic magnetic data and is composed of dipoles.

We have applied the Cholesky factorization (equations \ref{eq:Cholesky-factorization} and \ref{eq:Cholesky-solver}), 
the iterative deconvolution (Algorithms \ref{alg:TOB20-22} and \ref{alg:fast-2D-convolution}) proposed by 
\citet{takahashi-etal2020, takahashi-etal2022} and the direct deconvolution (equations \ref{eq:direct-deconvolution} and \ref{eq:matrix-L-Wiener-deconvolution})
with four different values for the parameter $\zeta$ to the $21$ gravity and $21$ magnetic data sets.

For each method, we have obtained one estimate $\tilde{\mathbf{p}}$ from the noise-free gravity data $\mathbf{d}$
and $L=20$ estimates $\tilde{\mathbf{p}}^{\ell}$ from the noise-corrupted gravity data $\mathbf{d}^{\ell}$, $\ell \in \{1:L\}$,
for the planar equivalent layer of point masses, totaling $21$ estimated parameter vectors and 
$20$ pairs $\left( \Delta p^{\ell} \: , \: \Delta d^{\ell} \right)$ of model and data perturbations
(equations \ref{eq:model-perturbation} and \ref{eq:data-perturbation}).
Other $21$ estimates for the parameter vector and 
$20$ pairs $\left( \Delta p^{\ell} \: , \: \Delta d^{\ell} \right)$ were obtained in the same way for the 
equivalent layer of dipoles by using the synthetic magnetic data.
Figures \ref{fig:3} and \ref{fig:6} show the numerical stability curves computed with each method for 
synthetic gravity and magnetic data, respectively.

All these $42$ estimated parameters vectors ($21$ for gravity and $21$ for magnetic data) were obtained by solving 
the overdetermined problem (equation \ref{eq:delta-q-tilde-overdetermined}) with the same method for the particular case in which
$\mathbf{H} = \mathbf{I}$ (equation \ref{eq:reparameterization} and 
subsection \ref{subsec:formulation-without-reparameterization}),
$\mathbf{W}_{d} = \mathbf{W}_{q} = \mathbf{I}$ (equations \ref{eq:function-Phi} and \ref{eq:function-Theta}) and
$\bar{\mathbf{p}} = \mathbf{0}$ (equation \ref{eq:reparameterization-reference}), where $\mathbf{I}$ is the identity of order $D$.

COMENTARIOS SOBRE AS CURVAS DE ESTABILIDADE (NECESSITA REVISÃO) $\Longrightarrow$
		
Figure \ref{fig:3} shows how the euclidian norm of the equivalent sources residuals varies as the level of the noise is increased for the gravimetric data. We can see that for all methods, a linear tendency can be observed as it is expected. The inclination of the straight line is a indicative of the stability of each method. As show in the graph the deconvolutional method is very unstable and it is really necessary to use a stabilization method to have a good parameter estimative. In contrast, a correct value of the stabilization parameter is necessary to not overshoot the smootheness of the solution as it is the case for the zeroth-order Tikhonov regularization as well. Using this gravimetric data, the optimal value for the Wiener stabilization parameter is $\mu = 10^{-20}$. 

For the magnetic data, figure \ref{fig:6} shows a very similar behavior of the stability as the previous case. The Wiener parameter seems to have the best solution for $\mu = 10^{-13}$. For both types of data the best Wiener parameter seems to be one that produces a low slope for the straight line in the stability analysis, discordant from the classical and convolutional methods. 

$\Longleftarrow$ COMENTARIOS SOBRE AS CURVAS DE ESTABILIDADE (NECESSITA REVISÃO)

COMENTARIOS SOBRE OS DADOS PREDITOS (NECESSITA REVISÃO) $\Longrightarrow$

Figure \ref{fig:5} shows the comparison of the predicted data for each method with the original data (figure \ref{fig:4}) using the most noised-corrupted data from the set of the stability analysis. The classical with zeroth-order Tikhonov regularization and the convolutional methods (figures \ref{fig:5}(A) and \ref{fig:5}(B)) yield very similar results for the predicted data confirming its similarities with the stabilization despite the bid difference in floating-point operations. Figure \ref{fig:5}(C) shows the deconvolutional method without a stabilization and demonstrates the necessity to use it for this method. Figure \ref{fig:5}(D) shows the deconvolutional method with Wiener stabilization $\mu = 10^{-15}$ which is too high, demonstrating the over smoothness of the predicted data. Figures \ref{fig:5}(E) and \ref{fig:5}(F) shows the predicted data for an optimal value of the Wiener parameter $\mu = 10^{-20}$ and a low value $\mu = 10^{-25}$, respectively.

Figure \ref{fig:8} shows the comparison of the predicted data for each method with the original magnetic data in figure \ref{fig:7} using the most noised-corrupted data modeled from the stability analyis. As the previous case the classical (figure \ref{fig:8}(A)) and the convolutional (figure \ref{fig:8}(B)) methods have very similar predicted data but estimated with less orders of magnitude in floating-point operations. The deconvoutional (figure \ref{fig:8}(C)) have have a strong disagreement with the observed data showing the need for a stabilization method.
Figure \ref{fig:8}(D) has a value of $\mu = 10^{-10}$ and the predicted data became to smooth by it. The optimal value of the Wiener parameter is shown in figure \ref{fig:8}(E) with $\mu = 10^{-13}$ and figure \ref{fig:8}(F) shows a predicted data with a low stablization value with $\mu = 10^{-16}$.

$\Longleftarrow$ COMENTARIOS SOBRE OS DADOS PREDITOS (NECESSITA REVISÃO)

COMENTARIOS SOBRE AS TRANSFORMAÇÕES (NECESSITA REVISÃO) $\Longrightarrow$

The upward continuation is a processing technique to visualize the data in a higher altitude. In practice is expected a lower amplitude signal and a smoother data as the high frequency anomalies tends to disapear. Figure  \ref{fig:grav_up}(A) shows the true modeled upward data at an height of $-500$ m. Figures \ref{fig:grav_up}(B), (C), (D) and (E) show the result of the upward processing for the classical, convolutional, deconvolutional and the deconvolutional with Wiener parameter $\mu = 10^{-20}$, respectively. It is clear that all methods seems to predict the upward data very reasonable, except the deconvolutional method without stabilization.

Figure \ref{fig:mag_up}(A) shows the true modeled upward data at an height of $-1400$ m. Figures \ref{fig:mag_up}(B), (C), (D) and (E) show the result of the upward processing for the classical, convolutional, deconvolutional and the deconvolutional with Wiener parameter $\mu = 10^{-13}$, respectively. As in the gravimetric case, all methods seems to predict the upward data, except the deconvolutional method without stabilization.

$\Longleftarrow$ COMENTARIOS SOBRE AS TRANSFORMAÇÕES (NECESSITA REVISÃO)

%Gravity synthetic statistics to be included:
%Means
%0.24791339230971493 (Classical method)
%0.25522040542133817 (CG BTTB method)
%0.86010282709889 (Deconvolutional method)
%1.53835137193657 (Deconvolutional w\ Wiener overshoot $\mu$ method)
%0.3134732823974472 (Deconvolutional w\ Wiener optimal $\mu$ method)
%0.5553048046997608 (Deconvolutional w\ Wiener suboptimal $\mu$ method)
%
%Standard deviations
%0.18274083156485463 (Classical method)
%0.18986126212291252 (CG BTTB method)
%1.439293452270024 (Deconvolutional method)
%1.1183051446613188 (Deconvolutional w\ Wiener overshoot $\mu$ method)
%0.2367045031838225 (Deconvolutional w\ Wiener optimal $\mu$ method)
%0.7047326489645682 (Deconvolutional w\ Wiener suboptimal $\mu$ method)
%\\\\
%Magnetic synthetic statistics to be included:
%
%Means
%
%6.572366904728528 (Classical method)
%6.689214592343857 (CG BTTB method)
%971.9310697001104 (Deconvolutional method)
%23.672356138290855 (Deconvolutional w\ Wiener overshoot μ method)
%8.09848247511561 (Deconvolutional w\ Wiener optimal μ method)
%29.264824940161848 (Deconvolutional w\ Wiener suboptimal μ method)
%
%standard deviations
%4.9276131862044315 (Classical method)
%4.9909561696899205 (CG BTTB method)
%1742.0801705255908 (Deconvolutional method)
%17.671099090589646 (Deconvolutional w\ Wiener overshoot μ method)
%6.1358737706945075 (Deconvolutional w\ Wiener optimal μ method)
%29.374157656258866 (Deconvolutional w\ Wiener suboptimal μ method)